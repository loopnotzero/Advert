
@Html.Partial("ArticlePublicationNavigationPartial")

<div class="container-fluid">
    <div class="row">
        <input type="text"/> 
        <textarea id="article-editor" style="display: none;"></textarea>
    </div>
</div>

<script>
    $(document).ready(function() {
        var simplemde = new SimpleMDE({
            status: false,
            element: $("#article-editor")[0],
            placeholder: "Type here...",
            fullScreen: true,
            withPreview: true
        });

        function createArticle(article) {
            $.ajax({
                url: "/Articles/CreateArticle",
                type: "POST",
                data: article,
                contentType: "application/json",
                error: function(jqXhr, textStatus, errorThrown) {
                    console.log("jqXhr: " + jqXhr);
                    console.log("textStatus: " + jqXhr);
                    console.log("errorThrown: " + jqXhr);
                },
                success: function(response) {
                    window.location.href = "/";
                }
            });
        }
        
        $("#submit-article").click(function(e) {
            e.preventDefault();
            
            var html = simplemde.options.previewRender(simplemde.value());
            
            var article = JSON.stringify({
                title: "Ловушка, в которую загнали себя инженеры Apple с клавиатурой MacBook Pro",
                text: html
            });    
            
            createArticle(article);
            
            return false;           
        });
    });
</script>