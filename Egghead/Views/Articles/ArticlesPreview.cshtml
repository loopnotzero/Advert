@* @{ ViewData["Title"] = "Home Page"; } *@

<header id="topnav">
    <div class="topbar-main">
        <div class="container-fluid">
            <div class="logo">
                <a href="/" class="logo">
                    <span class="logo-large"><i class="mdi mdi-android-head"></i> EGGHEAD</span>
                </a>
            </div>
            <div id="article-profile">
                <div class="menu-extras topbar-custom">
                    <ul class="list-inline float-right mb-0">
                        <li class="list-inline-item">
                            <button id="publish-article" class="btn btn-light waves-effect waves-light btn-sm">Publish an article</button>
                        </li>
                        @Html.Partial("ArticleProfilePartial")
                    </ul>
                </div>
            </div>
        </div>
    </div>
</header>

<div id="articles-preview" class="container-fluid">
    @* @Html.Partial("ArticlesPreviewPartial") *@
</div>

<script>
    $(document).ready(function() {
        function signOut(returnUrl) {
            $.ajax({
                url: "/Account/SignOut?returnUrl=" + returnUrl,
                type: "GET",
                contentType: "application/json",
                error: function(jqXhr, textStatus, errorThrown) {
                    console.log("jqXhr: " + jqXhr);
                    console.log("textStatus: " + jqXhr);
                    console.log("errorThrown: " + jqXhr);
                },
                success: function(response) {
                    window.location.href = response.redirectUrl;
                }
            });
        }

        function loadArticlesPreview() {
            $.ajax({
                url: "/Articles/GetArticlesPreview?articlesCount=25",
                type: "GET",
                contentType: "application/json",
                error: function(jqXhr, textStatus, errorThrown) {
                    console.log("jqXhr: " + jqXhr);
                    console.log("textStatus: " + jqXhr);
                    console.log("errorThrown: " + jqXhr);
                },
                success: function(response) {
                    $("#articles-preview").prepend(response);
                }
            });
        }

        $("#sign-out").click(function(e) {
            e.preventDefault();
            signOut(window.location.pathname);
            return false;
        });

        $("#publish-article").click(function(e) {
            e.preventDefault();
            window.location.href = "/Articles/ArticlePublication";
            return false;
        });

        loadArticlesPreview();
    });
</script>
